{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\r\n * axios统一封装\r\n * \r\n * @author xiaoRui\r\n * \r\n*/\n\nimport { Message } from \"element-ui\";\nimport axios from 'axios';\nimport router from \"@/router/router\";\nimport storage from \"./storage\";\n\n// 创建axios对象，添加全局配置\nconst service = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  timeout: 8000\n});\n\n// 请求拦截\nservice.interceptors.request.use(req => {\n  const headers = req.headers;\n  const token = storage.getItem(\"token\") || {};\n  if (!headers.Authorization) {\n    headers.Authorization = 'Bearer ' + token;\n  }\n  return req;\n});\n\n// 响应拦截\nservice.interceptors.response.use(res => {\n  const {\n    code,\n    data,\n    message\n  } = res.data;\n  if (code === 403) {\n    Message.error(message);\n    setTimeout(() => {\n      storage.clearAll();\n      router.push('/login');\n    }, 1500);\n  } else if (code === 406) {\n    Message.error(message);\n    setTimeout(() => {\n      storage.clearAll();\n      router.push('/login');\n    }, 1500);\n  } else {\n    return res;\n  }\n});\n\n// 请求核心函数\nfunction request(options) {\n  options.method = options.method || 'get';\n  if (options.method.toLowerCase() === 'get') {\n    options.params = options.data;\n  }\n  service.defaults.baseURL = process.env.VUE_APP_BASE_API;\n  return service(options);\n}\nexport default request;","map":{"version":3,"names":["Message","axios","router","storage","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","interceptors","request","use","req","headers","token","getItem","Authorization","response","res","code","data","message","error","setTimeout","clearAll","push","options","method","toLowerCase","params","defaults"],"sources":["/Users/kqwang/development/gowork/src/github.com/892294101/jx/jxweb/src/utils/request.js"],"sourcesContent":["/**\r\n * axios统一封装\r\n * \r\n * @author xiaoRui\r\n * \r\n*/\r\n\r\nimport { Message } from \"element-ui\"\r\nimport axios from 'axios'\r\nimport router from \"@/router/router\"\r\nimport storage from \"./storage\"\r\n\r\n// 创建axios对象，添加全局配置\r\nconst service = axios.create({\r\n    baseURL: process.env.VUE_APP_BASE_API,\r\n    timeout: 8000\r\n})\r\n\r\n// 请求拦截\r\nservice.interceptors.request.use((req) => {\r\n    const headers = req.headers\r\n    const token = storage.getItem(\"token\") || {}\r\n    if(!headers.Authorization) {\r\n        headers.Authorization = 'Bearer ' + token\r\n    }\r\n    return req\r\n})\r\n\r\n// 响应拦截\r\nservice.interceptors.response.use((res) => {\r\n    const {code, data, message} = res.data\r\n    if (code === 403) {\r\n        Message.error(message)\r\n        setTimeout(()=> {\r\n            storage.clearAll()\r\n            router.push('/login')\r\n        }, 1500)\r\n    } else if (code === 406) {\r\n        Message.error(message)\r\n        setTimeout(() => {\r\n            storage.clearAll()\r\n            router.push('/login')\r\n        }, 1500)\r\n    } else {\r\n        return res\r\n    }\r\n})\r\n\r\n// 请求核心函数\r\nfunction request(options) {\r\n    options.method = options.method || 'get'\r\n    if (options.method.toLowerCase() === 'get') {\r\n        options.params = options.data\r\n    }\r\n    service.defaults.baseURL = process.env.VUE_APP_BASE_API\r\n    return service(options)\r\n}\r\n\r\nexport default request\r\n\r\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,OAAO,QAAQ,YAAY;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,iBAAiB;AACpC,OAAOC,OAAO,MAAM,WAAW;;AAE/B;AACA,MAAMC,OAAO,GAAGH,KAAK,CAACI,MAAM,CAAC;EACzBC,OAAO,EAAEC,OAAO,CAACC,GAAG,CAACC,gBAAgB;EACrCC,OAAO,EAAE;AACb,CAAC,CAAC;;AAEF;AACAN,OAAO,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,GAAG,IAAK;EACtC,MAAMC,OAAO,GAAGD,GAAG,CAACC,OAAO;EAC3B,MAAMC,KAAK,GAAGb,OAAO,CAACc,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;EAC5C,IAAG,CAACF,OAAO,CAACG,aAAa,EAAE;IACvBH,OAAO,CAACG,aAAa,GAAG,SAAS,GAAGF,KAAK;EAC7C;EACA,OAAOF,GAAG;AACd,CAAC,CAAC;;AAEF;AACAV,OAAO,CAACO,YAAY,CAACQ,QAAQ,CAACN,GAAG,CAAEO,GAAG,IAAK;EACvC,MAAM;IAACC,IAAI;IAAEC,IAAI;IAAEC;EAAO,CAAC,GAAGH,GAAG,CAACE,IAAI;EACtC,IAAID,IAAI,KAAK,GAAG,EAAE;IACdrB,OAAO,CAACwB,KAAK,CAACD,OAAO,CAAC;IACtBE,UAAU,CAAC,MAAK;MACZtB,OAAO,CAACuB,QAAQ,CAAC,CAAC;MAClBxB,MAAM,CAACyB,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;EACZ,CAAC,MAAM,IAAIN,IAAI,KAAK,GAAG,EAAE;IACrBrB,OAAO,CAACwB,KAAK,CAACD,OAAO,CAAC;IACtBE,UAAU,CAAC,MAAM;MACbtB,OAAO,CAACuB,QAAQ,CAAC,CAAC;MAClBxB,MAAM,CAACyB,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;EACZ,CAAC,MAAM;IACH,OAAOP,GAAG;EACd;AACJ,CAAC,CAAC;;AAEF;AACA,SAASR,OAAOA,CAACgB,OAAO,EAAE;EACtBA,OAAO,CAACC,MAAM,GAAGD,OAAO,CAACC,MAAM,IAAI,KAAK;EACxC,IAAID,OAAO,CAACC,MAAM,CAACC,WAAW,CAAC,CAAC,KAAK,KAAK,EAAE;IACxCF,OAAO,CAACG,MAAM,GAAGH,OAAO,CAACN,IAAI;EACjC;EACAlB,OAAO,CAAC4B,QAAQ,CAAC1B,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,gBAAgB;EACvD,OAAOL,OAAO,CAACwB,OAAO,CAAC;AAC3B;AAEA,eAAehB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}