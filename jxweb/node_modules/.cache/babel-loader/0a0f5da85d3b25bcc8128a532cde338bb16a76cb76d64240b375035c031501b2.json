{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\r\n * axios统一封装\r\n *\r\n * @author xiaoRui\r\n *\r\n */\n\nimport { Message } from \"element-ui\";\nimport axios from 'axios';\nimport router from \"@/router/router\";\nimport storage from \"./storage\";\n\n// 创建axios对象，添加全局配置\nconst service = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  timeout: 8000,\n  headers: {\n    'Authorization': \"Bearer \" + storage.getCookie(\"token\"),\n    'Content-Type': 'application/json'\n  }\n});\n\n// 请求拦截\nservice.interceptors.request.use(req => {\n  const headers = req.headers;\n  const token = storage.getItem(\"token\") || {};\n  if (!headers.Authorization) {\n    headers.Authorization = 'Bearer ' + token;\n  }\n  return req;\n});\n\n// 响应拦截\nservice.interceptors.response.use(res => {\n  const {\n    code,\n    data,\n    message\n  } = res.data;\n  if (code === 403) {\n    Message.error(message);\n    setTimeout(() => {\n      storage.clearAll();\n      router.push('/login');\n    }, 1500);\n  } else if (code === 406) {\n    Message.error(message);\n    setTimeout(() => {\n      storage.clearAll();\n      router.push('/login');\n    }, 1500);\n  } else {\n    return res;\n  }\n});\n\n// 请求核心函数\nfunction request(options) {\n  options.method = options.method || 'get';\n  if (options.method.toLowerCase() === 'get') {\n    options.params = options.data;\n  }\n  service.defaults.baseURL = process.env.VUE_APP_BASE_API;\n  return service(options);\n}\nexport default request;","map":{"version":3,"names":["Message","axios","router","storage","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","headers","getCookie","interceptors","request","use","req","token","getItem","Authorization","response","res","code","data","message","error","setTimeout","clearAll","push","options","method","toLowerCase","params","defaults"],"sources":["/Users/kqwang/development/gowork/src/github.com/892294101/jx/jxweb/src/utils/request.js"],"sourcesContent":["/**\r\n * axios统一封装\r\n *\r\n * @author xiaoRui\r\n *\r\n */\r\n\r\nimport {Message} from \"element-ui\"\r\nimport axios from 'axios'\r\nimport router from \"@/router/router\"\r\nimport storage from \"./storage\"\r\n\r\n// 创建axios对象，添加全局配置\r\nconst service = axios.create({\r\n    baseURL: process.env.VUE_APP_BASE_API,\r\n    timeout: 8000,\r\n    headers: {\r\n        'Authorization': \"Bearer \" + storage.getCookie(\"token\"),\r\n        'Content-Type': 'application/json'\r\n    }\r\n})\r\n\r\n// 请求拦截\r\nservice.interceptors.request.use((req) => {\r\n    const headers = req.headers\r\n    const token = storage.getItem(\"token\") || {}\r\n    if (!headers.Authorization) {\r\n        headers.Authorization = 'Bearer ' + token\r\n    }\r\n    return req\r\n})\r\n\r\n// 响应拦截\r\nservice.interceptors.response.use((res) => {\r\n    const {code, data, message} = res.data\r\n    if (code === 403) {\r\n        Message.error(message)\r\n        setTimeout(() => {\r\n            storage.clearAll()\r\n            router.push('/login')\r\n        }, 1500)\r\n    } else if (code === 406) {\r\n        Message.error(message)\r\n        setTimeout(() => {\r\n            storage.clearAll()\r\n            router.push('/login')\r\n        }, 1500)\r\n    } else {\r\n        return res\r\n    }\r\n})\r\n\r\n// 请求核心函数\r\nfunction request(options) {\r\n    options.method = options.method || 'get'\r\n    if (options.method.toLowerCase() === 'get') {\r\n        options.params = options.data\r\n    }\r\n    service.defaults.baseURL = process.env.VUE_APP_BASE_API\r\n    return service(options)\r\n}\r\n\r\nexport default request\r\n\r\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAQA,OAAO,QAAO,YAAY;AAClC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,iBAAiB;AACpC,OAAOC,OAAO,MAAM,WAAW;;AAE/B;AACA,MAAMC,OAAO,GAAGH,KAAK,CAACI,MAAM,CAAC;EACzBC,OAAO,EAAEC,OAAO,CAACC,GAAG,CAACC,gBAAgB;EACrCC,OAAO,EAAE,IAAI;EACbC,OAAO,EAAE;IACL,eAAe,EAAE,SAAS,GAAGR,OAAO,CAACS,SAAS,CAAC,OAAO,CAAC;IACvD,cAAc,EAAE;EACpB;AACJ,CAAC,CAAC;;AAEF;AACAR,OAAO,CAACS,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,GAAG,IAAK;EACtC,MAAML,OAAO,GAAGK,GAAG,CAACL,OAAO;EAC3B,MAAMM,KAAK,GAAGd,OAAO,CAACe,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;EAC5C,IAAI,CAACP,OAAO,CAACQ,aAAa,EAAE;IACxBR,OAAO,CAACQ,aAAa,GAAG,SAAS,GAAGF,KAAK;EAC7C;EACA,OAAOD,GAAG;AACd,CAAC,CAAC;;AAEF;AACAZ,OAAO,CAACS,YAAY,CAACO,QAAQ,CAACL,GAAG,CAAEM,GAAG,IAAK;EACvC,MAAM;IAACC,IAAI;IAAEC,IAAI;IAAEC;EAAO,CAAC,GAAGH,GAAG,CAACE,IAAI;EACtC,IAAID,IAAI,KAAK,GAAG,EAAE;IACdtB,OAAO,CAACyB,KAAK,CAACD,OAAO,CAAC;IACtBE,UAAU,CAAC,MAAM;MACbvB,OAAO,CAACwB,QAAQ,CAAC,CAAC;MAClBzB,MAAM,CAAC0B,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;EACZ,CAAC,MAAM,IAAIN,IAAI,KAAK,GAAG,EAAE;IACrBtB,OAAO,CAACyB,KAAK,CAACD,OAAO,CAAC;IACtBE,UAAU,CAAC,MAAM;MACbvB,OAAO,CAACwB,QAAQ,CAAC,CAAC;MAClBzB,MAAM,CAAC0B,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;EACZ,CAAC,MAAM;IACH,OAAOP,GAAG;EACd;AACJ,CAAC,CAAC;;AAEF;AACA,SAASP,OAAOA,CAACe,OAAO,EAAE;EACtBA,OAAO,CAACC,MAAM,GAAGD,OAAO,CAACC,MAAM,IAAI,KAAK;EACxC,IAAID,OAAO,CAACC,MAAM,CAACC,WAAW,CAAC,CAAC,KAAK,KAAK,EAAE;IACxCF,OAAO,CAACG,MAAM,GAAGH,OAAO,CAACN,IAAI;EACjC;EACAnB,OAAO,CAAC6B,QAAQ,CAAC3B,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,gBAAgB;EACvD,OAAOL,OAAO,CAACyB,OAAO,CAAC;AAC3B;AAEA,eAAef,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}