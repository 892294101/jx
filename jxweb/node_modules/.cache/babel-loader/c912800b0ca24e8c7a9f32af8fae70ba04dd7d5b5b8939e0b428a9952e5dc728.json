{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport storage from '@/utils/storage';\nexport default {\n  data() {\n    return {\n      adminDetail: storage.getItem(\"sysAdmin\"),\n      activeName: 'first',\n      uploadIconUrl: 'http://localhost:2002/api/upload',\n      headers: {\n        Authorization: \"Bearer \" + storage.getItem(\"token\")\n      },\n      icon: '',\n      editFormRules: {\n        username: [{\n          required: true,\n          message: '请输入用户账号',\n          trigger: 'blur'\n        }],\n        email: [{\n          required: true,\n          message: '请输入用户邮箱',\n          trigger: 'blur'\n        }],\n        nickname: [{\n          required: true,\n          message: '请输入用户昵称',\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: true,\n          message: '请输入用户手机',\n          trigger: 'blur'\n        }],\n        note: [{\n          required: true,\n          message: '请输入用户备注',\n          trigger: 'blur'\n        }]\n      },\n      updateForm: {\n        password: '',\n        newPassword: '',\n        resetPassword: ''\n      },\n      updateFormRules: {\n        password: [{\n          required: true,\n          message: '请输入旧密码',\n          trigger: 'blur'\n        }],\n        newPassword: [{\n          required: true,\n          message: '请输入新密码',\n          trigger: 'blur'\n        }],\n        resetPassword: [{\n          required: true,\n          message: '请输入重复密码',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    // 成功调用图片信息\n    handleAvatarSuccess(res, file) {\n      this.icon = res.data;\n    },\n    // 修改个人信息\n    submitFirst() {\n      this.$refs.editFormRefForm.validate(async valid => {\n        if (!valid) return;\n        const {\n          data: res\n        } = await this.$api.adminUpdatePersonal({\n          icon: this.icon === '' ? this.adminDetail.icon : this.icon,\n          username: this.adminDetail.username,\n          email: this.adminDetail.email,\n          nickname: this.adminDetail.nickname,\n          phone: this.adminDetail.phone,\n          note: this.adminDetail.note\n        });\n        if (res.code !== 200) {\n          this.$message.error(res.message);\n        } else {\n          this.$storage.clearItem(\"sysAdmin\");\n          this.$store.commit('saveSysAdmin', res.data);\n          await this.$router.push('/home');\n          this.$message.success('修改用户成功');\n        }\n      });\n    },\n    closeFirst() {\n      this.$router.push('/home');\n    },\n    // 修改个人密码\n    submitSecond() {\n      this.$refs.updateFormRefForm.validate(async valid => {\n        if (!valid) return;\n        const {\n          data: res\n        } = await this.$api.adminUpdatePersonalPassword({\n          password: this.updateForm.password,\n          newPassword: this.updateForm.newPassword,\n          resetPassword: this.updateForm.resetPassword\n        });\n        if (res.code !== 200) {\n          this.$message.error(res.message);\n        } else {\n          this.$storage.clearAll();\n          this.$router.push(\"/login\");\n          this.$message.success('修改密码成功');\n        }\n      });\n    },\n    // 关闭页面跳转到首页\n    closeSecond() {\n      this.$router.push('/home');\n    }\n  }\n};","map":{"version":3,"names":["storage","data","adminDetail","getItem","activeName","uploadIconUrl","headers","Authorization","icon","editFormRules","username","required","message","trigger","email","nickname","phone","note","updateForm","password","newPassword","resetPassword","updateFormRules","methods","handleAvatarSuccess","res","file","submitFirst","$refs","editFormRefForm","validate","valid","$api","adminUpdatePersonal","code","$message","error","$storage","clearItem","$store","commit","$router","push","success","closeFirst","submitSecond","updateFormRefForm","adminUpdatePersonalPassword","clearAll","closeSecond"],"sources":["src/views/Personal.vue"],"sourcesContent":["<template xmlns=\"http://www.w3.org/1999/html\">\r\n    <el-row :gutter=\"20\" style=\"height: 100%; width: 100%;\">\r\n        <el-col :xs=\"26\" :sm=\"26\" :md=\"10\" :lg=\"8\" :xl=\"7\" style=\"margin-bottom: 10px\">\r\n            <el-card class=\"box-card\" style=\"height: 80vh\" >\r\n                <div slot=\"header\" class=\"clearfix\">\r\n                    <span>个人信息</span>\r\n                </div>\r\n                <div>\r\n                    <div style=\"text-align: center\">\r\n                        <el-avatar :src=\"adminDetail.icon\"></el-avatar>\r\n                    </div>\r\n                    <br/>\r\n                    <el-form label-width=\"100px\" size=\"mini\" >\r\n                        <el-row>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"用户账号：\">{{ adminDetail.username }}</el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"用户昵称：\">{{ adminDetail.nickname }}</el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"用户邮箱：\">{{ adminDetail.email }}</el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"用户电话：\">{{ adminDetail.phone }}</el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"用户备注：\">{{ adminDetail.note }}</el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"24\">\r\n                                <el-form-item label=\"创建时间：\">{{ adminDetail.createTime }}</el-form-item>\r\n                            </el-col>\r\n                        </el-row>\r\n                    </el-form>\r\n                </div>\r\n            </el-card>\r\n        </el-col>\r\n        <el-col :xs=\"22\" :sm=\"22\" :md=\"14\" :lg=\"16\" :xl=\"17\">\r\n            <el-card class=\"box-card\" style=\"height: 80vh\">\r\n                <div slot=\"header\" class=\"clearfix\">\r\n                    <span>基本资料</span>\r\n                </div>\r\n                <el-tabs v-model=\"activeName\">\r\n                    <el-tab-pane label=\"基本资料\" name=\"first\">\r\n                        <el-form size=\"mini\" :model=\"adminDetail\" :rules=\"editFormRules\" ref=\"editFormRefForm\" label-width=\"80px\">\r\n                            <el-form-item label=\"用户头像\" prop=\"icon\">\r\n                                <el-upload :headers=headers class=\"avatar-uploader\" :action=\"uploadIconUrl\"\r\n                                    :show-file-list=\"false\" :on-success=\"handleAvatarSuccess\">\r\n                                    <img v-if=\"icon\" :src=\"icon\" class=\"avatar\" title=\"点击更换头像\">\r\n                                    <img v-else=\"!icon\" :src=\"adminDetail.icon\" class=\"avatar\" title=\"点击更换头像\">\r\n                                </el-upload>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"用户账号\" prop=\"username\">\r\n                                <el-input v-model=\"adminDetail.username\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"用户昵称\" prop=\"nickname\">\r\n                                <el-input v-model=\"adminDetail.nickname\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"手机号码\" prop=\"phone\">\r\n                                <el-input v-model=\"adminDetail.phone\" maxlength=\"11\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"用户邮箱\" prop=\"email\">\r\n                                <el-input v-model=\"adminDetail.email\" maxlength=\"50\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"用户备注\" prop=\"note\">\r\n                                <el-input v-model=\"adminDetail.note\" />\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button type=\"primary\" size=\"mini\" @click=\"submitFirst\">保存</el-button>\r\n                                <el-button type=\"danger\" size=\"mini\" @click=\"closeFirst\">关闭</el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"修改密码\" name=\"second\">\r\n                        <el-form size=\"mini\" :model=\"updateForm\" :rules=\"updateFormRules\" ref=\"updateFormRefForm\" label-width=\"80px\">\r\n                            <el-form-item label=\"旧密码\" prop=\"password\">\r\n                                <el-input v-model=\"updateForm.password\" placeholder=\"请输入旧密码\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n                                <el-input v-model=\"updateForm.newPassword\" placeholder=\"请输入新密码\" />\r\n                            </el-form-item>\r\n                            <el-form-item label=\"确认密码\" prop=\"resetPassword\">\r\n                                <el-input v-model=\"updateForm.resetPassword\" placeholder=\"请确认密码\" />\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button type=\"primary\" size=\"mini\" @click=\"submitSecond\">保存</el-button>\r\n                                <el-button type=\"danger\" size=\"mini\" @click=\"closeSecond\">关闭</el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </el-tab-pane>\r\n                </el-tabs>\r\n            </el-card>\r\n        </el-col>\r\n    </el-row>\r\n</template>\r\n\r\n<script>\r\nimport storage from '@/utils/storage'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            adminDetail: storage.getItem(\"sysAdmin\"),\r\n            activeName: 'first',\r\n            uploadIconUrl: 'http://localhost:2002/api/upload',\r\n            headers: {\r\n                Authorization: \"Bearer \" + storage.getItem(\"token\"),\r\n            },\r\n            icon: '',\r\n            editFormRules: {\r\n                username: [{ required: true, message: '请输入用户账号', trigger: 'blur' }],\r\n                email: [{ required: true, message: '请输入用户邮箱', trigger: 'blur' }],\r\n                nickname: [{ required: true, message: '请输入用户昵称', trigger: 'blur' }],\r\n                phone: [{ required: true, message: '请输入用户手机', trigger: 'blur' }],\r\n                note: [{ required: true, message: '请输入用户备注', trigger: 'blur' }],\r\n            },\r\n            updateForm: {\r\n                password: '',\r\n                newPassword: '',\r\n                resetPassword: ''\r\n            },\r\n            updateFormRules: {\r\n                password: [{ required: true, message: '请输入旧密码', trigger: 'blur' }],\r\n                newPassword: [{ required: true, message: '请输入新密码', trigger: 'blur' }],\r\n                resetPassword: [{ required: true, message: '请输入重复密码', trigger: 'blur' }],\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        // 成功调用图片信息\r\n        handleAvatarSuccess(res, file) {\r\n            this.icon = res.data;\r\n        },\r\n        // 修改个人信息\r\n        submitFirst() {\r\n            this.$refs.editFormRefForm.validate(async valid => {\r\n                if (!valid) return\r\n                const { data: res } = await this.$api.adminUpdatePersonal({\r\n                    icon: this.icon === '' ? this.adminDetail.icon : this.icon,\r\n                    username: this.adminDetail.username,\r\n                    email: this.adminDetail.email,\r\n                    nickname: this.adminDetail.nickname,\r\n                    phone: this.adminDetail.phone,\r\n                    note: this.adminDetail.note,\r\n                })\r\n                if (res.code !== 200) {\r\n                    this.$message.error(res.message);\r\n                } else {\r\n                    this.$storage.clearItem(\"sysAdmin\")\r\n                    this.$store.commit('saveSysAdmin', res.data)\r\n                    await this.$router.push('/home')\r\n                    this.$message.success('修改用户成功')\r\n                }\r\n            })\r\n        },\r\n        closeFirst() {\r\n            this.$router.push('/home')\r\n        },\r\n        // 修改个人密码\r\n        submitSecond() {\r\n            this.$refs.updateFormRefForm.validate(async valid => {\r\n                if (!valid) return\r\n                const { data: res } = await this.$api.adminUpdatePersonalPassword({\r\n                    password: this.updateForm.password,\r\n                    newPassword: this.updateForm.newPassword,\r\n                    resetPassword: this.updateForm.resetPassword\r\n                })\r\n                if (res.code !== 200) {\r\n                    this.$message.error(res.message);\r\n                } else {\r\n                    this.$storage.clearAll()\r\n                    this.$router.push(\"/login\")\r\n                    this.$message.success('修改密码成功')\r\n                }\r\n            })\r\n        },\r\n        // 关闭页面跳转到首页\r\n        closeSecond() {\r\n            this.$router.push('/home')\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.el-avatar {\r\n    height: 130px;\r\n    width: 130px;\r\n}\r\n\r\n.avatar-uploader {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    width: 50px;\r\n    height: 50px;\r\n    position: relative;\r\n    overflow: hidden;\r\n\r\n    .avatar {\r\n        width: 50px;\r\n        height: 50px;\r\n        display: block;\r\n    }\r\n}\r\n</style>"],"mappings":";AAiGA,OAAAA,OAAA;AAEA;EACAC,KAAA;IACA;MACAC,WAAA,EAAAF,OAAA,CAAAG,OAAA;MACAC,UAAA;MACAC,aAAA;MACAC,OAAA;QACAC,aAAA,cAAAP,OAAA,CAAAG,OAAA;MACA;MACAK,IAAA;MACAC,aAAA;QACAC,QAAA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAC,KAAA;UAAAH,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAE,QAAA;UAAAJ,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAG,KAAA;UAAAL,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAI,IAAA;UAAAN,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;MACAK,UAAA;QACAC,QAAA;QACAC,WAAA;QACAC,aAAA;MACA;MACAC,eAAA;QACAH,QAAA;UAAAR,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAO,WAAA;UAAAT,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAQ,aAAA;UAAAV,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;IACA;EACA;EACAU,OAAA;IACA;IACAC,oBAAAC,GAAA,EAAAC,IAAA;MACA,KAAAlB,IAAA,GAAAiB,GAAA,CAAAxB,IAAA;IACA;IACA;IACA0B,YAAA;MACA,KAAAC,KAAA,CAAAC,eAAA,CAAAC,QAAA,OAAAC,KAAA;QACA,KAAAA,KAAA;QACA;UAAA9B,IAAA,EAAAwB;QAAA,eAAAO,IAAA,CAAAC,mBAAA;UACAzB,IAAA,OAAAA,IAAA,eAAAN,WAAA,CAAAM,IAAA,QAAAA,IAAA;UACAE,QAAA,OAAAR,WAAA,CAAAQ,QAAA;UACAI,KAAA,OAAAZ,WAAA,CAAAY,KAAA;UACAC,QAAA,OAAAb,WAAA,CAAAa,QAAA;UACAC,KAAA,OAAAd,WAAA,CAAAc,KAAA;UACAC,IAAA,OAAAf,WAAA,CAAAe;QACA;QACA,IAAAQ,GAAA,CAAAS,IAAA;UACA,KAAAC,QAAA,CAAAC,KAAA,CAAAX,GAAA,CAAAb,OAAA;QACA;UACA,KAAAyB,QAAA,CAAAC,SAAA;UACA,KAAAC,MAAA,CAAAC,MAAA,iBAAAf,GAAA,CAAAxB,IAAA;UACA,WAAAwC,OAAA,CAAAC,IAAA;UACA,KAAAP,QAAA,CAAAQ,OAAA;QACA;MACA;IACA;IACAC,WAAA;MACA,KAAAH,OAAA,CAAAC,IAAA;IACA;IACA;IACAG,aAAA;MACA,KAAAjB,KAAA,CAAAkB,iBAAA,CAAAhB,QAAA,OAAAC,KAAA;QACA,KAAAA,KAAA;QACA;UAAA9B,IAAA,EAAAwB;QAAA,eAAAO,IAAA,CAAAe,2BAAA;UACA5B,QAAA,OAAAD,UAAA,CAAAC,QAAA;UACAC,WAAA,OAAAF,UAAA,CAAAE,WAAA;UACAC,aAAA,OAAAH,UAAA,CAAAG;QACA;QACA,IAAAI,GAAA,CAAAS,IAAA;UACA,KAAAC,QAAA,CAAAC,KAAA,CAAAX,GAAA,CAAAb,OAAA;QACA;UACA,KAAAyB,QAAA,CAAAW,QAAA;UACA,KAAAP,OAAA,CAAAC,IAAA;UACA,KAAAP,QAAA,CAAAQ,OAAA;QACA;MACA;IACA;IACA;IACAM,YAAA;MACA,KAAAR,OAAA,CAAAC,IAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}