{"ast":null,"code":"import Treeselect from \"@riophae/vue-treeselect\";\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\nexport default {\n  components: {\n    Treeselect\n  },\n  data() {\n    return {\n      data: [{\n        id: 1,\n        label: '一级 1',\n        children: [{\n          id: 4,\n          label: '二级 1-1',\n          children: [{\n            id: 9,\n            label: '三级 1-1-1'\n          }, {\n            id: 10,\n            label: '三级 1-1-2'\n          }]\n        }]\n      }, {\n        id: 2,\n        label: '一级 2',\n        children: [{\n          id: 5,\n          label: '二级 2-1'\n        }, {\n          id: 6,\n          label: '二级 2-2'\n        }]\n      }, {\n        id: 3,\n        label: '一级 3',\n        children: [{\n          id: 7,\n          label: '二级 3-1'\n        }, {\n          id: 8,\n          label: '二级 3-2'\n        }]\n      }],\n      statusList: [{\n        value: '1',\n        label: '启用'\n      }, {\n        value: '2',\n        label: '停用'\n      }],\n      defaultProps: {\n        children: 'children',\n        label: 'label'\n      },\n      queryParams: {},\n      Loading: false,\n      roleList: [],\n      total: 0,\n      addRoleDialogVisible: false,\n      addRoleForm: {\n        roleName: '',\n        roleKey: '',\n        description: '',\n        status: 1\n      },\n      addRoleFormRules: {\n        roleName: [{\n          required: true,\n          message: '请输入角色名称',\n          trigger: 'blur'\n        }],\n        roleKey: [{\n          required: true,\n          message: '请角色权限标识',\n          trigger: 'blur'\n        }],\n        status: [{\n          required: true,\n          message: '请输入角色状态',\n          trigger: 'blur'\n        }],\n        description: [{\n          required: true,\n          message: '请输入角色描述',\n          trigger: 'blur'\n        }]\n      },\n      editRoleDialogVisible: false,\n      roleInfo: {},\n      editRoleFormRules: {\n        roleName: [{\n          required: true,\n          message: '请输入角色名称',\n          trigger: 'blur'\n        }],\n        roleKey: [{\n          required: true,\n          message: '请输入角色权限标识',\n          trigger: 'blur'\n        }],\n        status: [{\n          required: true,\n          message: '请输入角色状态',\n          trigger: 'blur'\n        }],\n        description: [{\n          required: true,\n          message: '请输入角色描述',\n          trigger: 'blur'\n        }]\n      },\n      setMenuDialogVisible: false,\n      menuList: [],\n      treeProps: {\n        label: 'label'\n      },\n      defKeys: [],\n      id: ''\n    };\n  },\n  methods: {\n    // 列表\n    async getRoleList() {\n      this.Loading = true;\n      const {\n        data: res\n      } = await this.$api.queryRoleList(this.queryParams);\n      if (res.code !== 200) {\n        this.$message.error(res.message);\n      } else {\n        this.roleList = res.data.list;\n        this.total = res.data.total;\n        this.Loading = false;\n      }\n    },\n    // 搜索\n    handleQuery() {\n      this.getRoleList();\n    },\n    // 重置\n    resetQuery() {\n      this.queryParams = {};\n      this.getRoleList();\n      this.$message.success(\"重置成功\");\n    },\n    // pageSize\n    handleSizeChange(newSize) {\n      this.queryParams.pageSize = newSize;\n      this.getRoleList();\n    },\n    // pageNum\n    handleCurrentChange(newPage) {\n      this.queryParams.pageNum = newPage;\n      this.getRoleList();\n    },\n    // 启用/停用\n    async roleUpdateStatus(row) {\n      let text = row.status === 2 ? \"停用\" : \"启用\";\n      const confirmResult = await this.$confirm('确认要\"' + text + '\"\"' + row.roleName + '\"角色吗?', \"警告\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).catch(err => err);\n      if (confirmResult !== 'confirm') {\n        await this.getRoleList();\n        return this.$message.info('已取消删除');\n      }\n      await this.$api.updateRoleStatus(row.id, row.status);\n      return this.$message.success(text + \"成功\");\n      //await this.getRoleList()\n    },\n    // 监听添加角色对话框关闭\n    addRoleDialogClosed() {\n      this.$refs.addRoleFormRefForm.resetFields();\n    },\n    // 新增\n    addRole() {\n      this.$refs.addRoleFormRefForm.validate(async valid => {\n        if (!valid) return;\n        const {\n          data: res\n        } = await this.$api.addRole(this.addRoleForm);\n        if (res.code !== 200) {\n          this.$message.error(res.message);\n        } else {\n          this.$message.success(\"新增角色成功\");\n          this.addRoleDialogVisible = false;\n          await this.getRoleList();\n        }\n      });\n    },\n    // 监听修改角色对话框的关闭事件\n    editRoleDialogClosed() {\n      this.$refs.editRoleFormRefForm.resetFields();\n    },\n    // 展示修改对话框\n    async showEditRoleDialog(id) {\n      const {\n        data: res\n      } = await this.$api.roleInfo(id);\n      if (res.code !== 200) {\n        this.$message.error(res.message);\n      } else {\n        this.roleInfo = res.data;\n        this.editRoleDialogVisible = true;\n      }\n    },\n    // 修改角色信息并提交\n    editRole() {\n      this.$refs.editRoleFormRefForm.validate(async valid => {\n        if (!valid) return;\n        const {\n          data: res\n        } = await this.$api.roleUpdate(this.roleInfo);\n        if (res.code !== 200) {\n          this.$message.error(res.message);\n        } else {\n          this.editRoleDialogVisible = false;\n          await this.getRoleList();\n          this.$message.success(\"修改角色成功\");\n        }\n      });\n    },\n    // 删除角色\n    async handleRoleDelete(row) {\n      const confirmResult = await this.$confirm('是否确认删除角色为\"' + row.roleName + '\"的数据项？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err => err);\n      if (confirmResult !== 'confirm') {\n        return this.$message.info('已取消删除');\n      }\n      const {\n        data: res\n      } = await this.$api.deleteRole(row.id);\n      console.log(row.id);\n      if (res.code !== 200) {\n        this.$message.error(res.message);\n      } else {\n        this.$message.success('删除成功');\n        await this.getRoleList();\n      }\n    },\n    // 展示分配菜单权限对话框\n    showSetMenuDialog(role) {\n      this.id = role.id;\n      this.$api.querySysMenuVoList().then(res => {\n        this.menuList = this.$handleTree.toTreeList(res.data.data);\n      });\n      this.$api.QueryRoleMenuIdList(role.id).then(res => {\n        this.defKeys = res.data.data;\n      });\n      console.log(this.data);\n      this.setMenuDialogVisible = true;\n    },\n    // 监听对话框关闭事件\n    setRightDialogClosed() {\n      this.defKeys = [];\n    },\n    // 分配菜单权限\n    async allotMenus() {\n      const keys = [...this.$refs.treeRef.getCheckedKeys(), ...this.$refs.treeRef.getHalfCheckedKeys()];\n      const {\n        data: res\n      } = await this.$api.AssignPermissions(this.id, keys);\n      if (res.code !== 200) {\n        this.$message.error(res.message);\n      } else {\n        this.$message.success('分配权限成功');\n        await this.getRoleList();\n        this.setMenuDialogVisible = false;\n      }\n    }\n  },\n  created() {\n    this.getRoleList();\n  }\n};","map":{"version":3,"names":["Treeselect","components","data","id","label","children","statusList","value","defaultProps","queryParams","Loading","roleList","total","addRoleDialogVisible","addRoleForm","roleName","roleKey","description","status","addRoleFormRules","required","message","trigger","editRoleDialogVisible","roleInfo","editRoleFormRules","setMenuDialogVisible","menuList","treeProps","defKeys","methods","getRoleList","res","$api","queryRoleList","code","$message","error","list","handleQuery","resetQuery","success","handleSizeChange","newSize","pageSize","handleCurrentChange","newPage","pageNum","roleUpdateStatus","row","text","confirmResult","$confirm","confirmButtonText","cancelButtonText","type","catch","err","info","updateRoleStatus","addRoleDialogClosed","$refs","addRoleFormRefForm","resetFields","addRole","validate","valid","editRoleDialogClosed","editRoleFormRefForm","showEditRoleDialog","editRole","roleUpdate","handleRoleDelete","deleteRole","console","log","showSetMenuDialog","role","querySysMenuVoList","then","$handleTree","toTreeList","QueryRoleMenuIdList","setRightDialogClosed","allotMenus","keys","treeRef","getCheckedKeys","getHalfCheckedKeys","AssignPermissions","created"],"sources":["src/views/base/Role.vue"],"sourcesContent":["<template>\r\n  <el-card>\r\n    <!--搜索-->\r\n    <el-form size=\"mini\" :inline=\"true\" :model=\"queryParams\">\r\n      <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n        <el-input class=\"searchList\" placeholder=\"请输入角色名称\" size=\"mini\" clearable v-model=\"queryParams.roleName\"\r\n                  @keyup.enter.native=\"handleQuery\" clearable></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"账号状态\" prop=\"status\">\r\n        <el-select class=\"searchList\" size=\"mini\" placeholder=\"请选择账号状态\" v-model=\"queryParams.status\" clearable>\r\n          <el-option v-for=\"item in statusList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"/>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"开始时间\" prop=\"beginTime\">\r\n        <el-date-picker class=\"input-width\" size=\"mini\" type=\"date\" style=\"width:135px\" value-format=\"yyyy-MM-dd\"\r\n                        clearable placeholder=\"请选择开始时间\" v-model=\"queryParams.beginTime\" @keyup.enter.native=\"handleQuery\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"结束时间\" prop=\"endTime\">\r\n        <el-date-picker class=\"input-width\" size=\"mini\" type=\"date\" style=\"width:135px\" value-format=\"yyyy-MM-dd\"\r\n                        clearable placeholder=\"请选择结束时间\" v-model=\"queryParams.endTime\" @keyup.enter.native=\"handleQuery\"/>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\r\n        <el-button type=\"primary\" icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <!--操作按钮-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button plain type=\"primary\" icon=\"el-icon-plus\" size=\"mini\"\r\n                   @click=\"addRoleDialogVisible = true\" v-authority=\"['base:role:add']\">新增\r\n        </el-button>\r\n      </el-col>\r\n    </el-row>\r\n    <!--列表-->\r\n    <el-table size=\"mini\" border stripe v-loading=\"Loading\" :data=\"roleList\" style=\"width: 100%\"\r\n              :header-cell-style=\"{ background: '#eef1f6', color: '#606266' }\">\r\n      <el-table-column label=\"ID\" prop=\"id\" v-if=\"false\"/>\r\n      <el-table-column fixed label=\"角色名称\" prop=\"roleName\"/>\r\n      <el-table-column label=\"权限字符串\" prop=\"roleKey\"/>\r\n      <el-table-column label=\"创建时间\" prop=\"createTime\"/>\r\n      <el-table-column label=\"账号状态\">\r\n        <template slot-scope=\"scope\">\r\n          <el-switch v-model=\"scope.row.status\" :active-value=\"1\" :inactive-value=\"2\" active-color=\"#13ce66\"\r\n                     inactive-color=\"#F5222D\" active-text=\"启用\" inactive-text=\"停用\" @change=\"roleUpdateStatus(scope.row)\">\r\n          </el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"描述\" prop=\"description\"/>\r\n      <el-table-column label=\"更多操作\" fixed=\"right\" width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"small\" type=\"text\" icon=\"el-icon-edit\" @click=\"showEditRoleDialog(scope.row.id)\" v-authority=\"['base:role:edit']\">编辑\r\n          </el-button>\r\n          <el-button size=\"small\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleRoleDelete(scope.row)\" v-authority=\"['base:role:delete']\">删除\r\n          </el-button>\r\n          <el-button size=\"small\" type=\"text\" icon=\"el-icon-setting\" @click=\"showSetMenuDialog(scope.row)\" v-authority=\"['base:role:assign']\">分配权限\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!--分页区域-->\r\n    <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\"\r\n                   :current-page=\"queryParams.pageNum\" :page-sizes=\"[10, 50, 100, 500, 1000]\" :page-size=\"queryParams.pageSize\"\r\n                   layout=\"total, sizes, prev, pager, next, jumper\" :total=\"total\">\r\n    </el-pagination>\r\n    <!--新增角色-->\r\n    <el-dialog title=\"新增角色\" :visible.sync=\"addRoleDialogVisible\" width=\"30%\" @close=\"addRoleDialogClosed\">\r\n      <el-form size=\"mini\" ref=\"addRoleFormRefForm\" label-width=\"80px\" :model=\"addRoleForm\" :rules=\"addRoleFormRules\">\r\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n          <el-input placeholder=\"请输入角色名称\" v-model=\"addRoleForm.roleName\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色标识\" prop=\"roleKey\">\r\n          <el-input placeholder=\"请输入角色标识\" v-model=\"addRoleForm.roleKey\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色状态\" prop=\"status\">\r\n          <el-radio-group v-model=\"addRoleForm.status\">\r\n            <el-radio :label=\"1\">正常</el-radio>\r\n            <el-radio :label=\"2\">停用</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色描述\" prop=\"description\">\r\n          <el-input placeholder=\"请输入角色描述\" type=\"textarea\" v-model=\"addRoleForm.description\"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"addRole\">确 定</el-button>\r\n                <el-button type=\"primary\" @click=\"addRoleDialogVisible = false\">取 消</el-button>\r\n            </span>\r\n    </el-dialog>\r\n    <!--编辑角色-->\r\n    <el-dialog title=\"编辑角色\" :visible.sync=\"editRoleDialogVisible\" width=\"30%\" @close=\"editRoleDialogClosed\">\r\n      <el-form size=\"mini\" ref=\"editRoleFormRefForm\" label-width=\"80px\" :model=\"roleInfo\" :rules=\"editRoleFormRules\">\r\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\r\n          <el-input placeholder=\"请输入角色名称\" v-model=\"roleInfo.roleName\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色标识\" prop=\"roleKey\">\r\n          <el-input placeholder=\"请输入角色标识\" v-model=\"roleInfo.roleKey\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色状态\" prop=\"status\">\r\n          <el-radio-group v-model=\"roleInfo.status\">\r\n            <el-radio :label=\"1\">正常</el-radio>\r\n            <el-radio :label=\"2\">停用</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色描述\" prop=\"status\">\r\n          <el-input placeholder=\"请输入角色描述\" type=\"textarea\" v-model=\"roleInfo.description\"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"editRole\">确 定</el-button>\r\n                <el-button type=\"primary\" @click=\"editRoleDialogVisible = false\">取 消</el-button>\r\n            </span>\r\n    </el-dialog>\r\n    <!--分配权限-->\r\n    <el-dialog title=\"分配权限\" :visible.sync=\"setMenuDialogVisible\" @close=\"setRightDialogClosed\">\r\n      <div class=\"Permission-Assignment \">\r\n        <el-tree class=\"Permission-Assignment-tree\" :data=\"menuList\" :props=\"treeProps\" show-checkbox node-key=\"id\"\r\n                 default-expand-all ref=\"treeRef\" :default-checked-keys=\"defKeys\" ></el-tree> <!-- :default-checked-keys=\"defKeys\" -->\r\n        <el-tree\r\n            :data=\"data\"\r\n            show-checkbox\r\n            node-key=\"id\"\r\n            :default-expanded-keys=\"[2, 3]\"\r\n            :default-checked-keys=\"[5]\"\r\n            :props=\"defaultProps\">\r\n        </el-tree>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"allotMenus\">确 定</el-button>\r\n        <el-button type=\"primary\" @click=\"setMenuDialogVisible = false\">取 消</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport Treeselect from \"@riophae/vue-treeselect\"\r\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\"\r\n\r\nexport default {\r\n  components: {Treeselect},\r\n  data() {\r\n    return {\r\n      data: [{\r\n        id: 1,\r\n        label: '一级 1',\r\n        children: [{\r\n          id: 4,\r\n          label: '二级 1-1',\r\n          children: [{\r\n            id: 9,\r\n            label: '三级 1-1-1'\r\n          }, {\r\n            id: 10,\r\n            label: '三级 1-1-2'\r\n          }]\r\n        }]\r\n      }, {\r\n        id: 2,\r\n        label: '一级 2',\r\n        children: [{\r\n          id: 5,\r\n          label: '二级 2-1'\r\n        }, {\r\n          id: 6,\r\n          label: '二级 2-2'\r\n        }]\r\n      }, {\r\n        id: 3,\r\n        label: '一级 3',\r\n        children: [{\r\n          id: 7,\r\n          label: '二级 3-1'\r\n        }, {\r\n          id: 8,\r\n          label: '二级 3-2'\r\n        }]\r\n      }],\r\n      statusList: [{\r\n        value: '1',\r\n        label: '启用'\r\n      }, {\r\n        value: '2',\r\n        label: '停用'\r\n      }],\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'label'\r\n      },\r\n      queryParams: {},\r\n      Loading: false,\r\n      roleList: [],\r\n      total: 0,\r\n      addRoleDialogVisible: false,\r\n      addRoleForm: {\r\n        roleName: '',\r\n        roleKey: '',\r\n        description: '',\r\n        status: 1\r\n      },\r\n      addRoleFormRules: {\r\n        roleName: [{required: true, message: '请输入角色名称', trigger: 'blur'}],\r\n        roleKey: [{required: true, message: '请角色权限标识', trigger: 'blur'}],\r\n        status: [{required: true, message: '请输入角色状态', trigger: 'blur'}],\r\n        description: [{required: true, message: '请输入角色描述', trigger: 'blur'}],\r\n      },\r\n      editRoleDialogVisible: false,\r\n      roleInfo: {},\r\n      editRoleFormRules: {\r\n        roleName: [{required: true, message: '请输入角色名称', trigger: 'blur'}],\r\n        roleKey: [{required: true, message: '请输入角色权限标识', trigger: 'blur'}],\r\n        status: [{required: true, message: '请输入角色状态', trigger: 'blur'}],\r\n        description: [{required: true, message: '请输入角色描述', trigger: 'blur'}],\r\n      },\r\n      setMenuDialogVisible: false,\r\n      menuList: [],\r\n      treeProps: {\r\n        label: 'label'\r\n      },\r\n      defKeys: [],\r\n      id: '',\r\n    }\r\n  },\r\n  methods: {\r\n    // 列表\r\n    async getRoleList() {\r\n      this.Loading = true\r\n      const {data: res} = await this.$api.queryRoleList(this.queryParams)\r\n      if (res.code !== 200) {\r\n        this.$message.error(res.message);\r\n      } else {\r\n        this.roleList = res.data.list\r\n        this.total = res.data.total\r\n        this.Loading = false\r\n      }\r\n    },\r\n    // 搜索\r\n    handleQuery() {\r\n      this.getRoleList()\r\n    },\r\n    // 重置\r\n    resetQuery() {\r\n      this.queryParams = {}\r\n      this.getRoleList()\r\n      this.$message.success(\"重置成功\")\r\n    },\r\n    // pageSize\r\n    handleSizeChange(newSize) {\r\n      this.queryParams.pageSize = newSize\r\n      this.getRoleList()\r\n    },\r\n    // pageNum\r\n    handleCurrentChange(newPage) {\r\n      this.queryParams.pageNum = newPage\r\n      this.getRoleList()\r\n    },\r\n    // 启用/停用\r\n    async roleUpdateStatus(row) {\r\n      let text = row.status === 2 ? \"停用\" : \"启用\"\r\n      const confirmResult = await this.$confirm('确认要\"' + text + '\"\"' + row.roleName + '\"角色吗?', \"警告\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }).catch(err => err)\r\n      if (confirmResult !== 'confirm') {\r\n        await this.getRoleList()\r\n        return this.$message.info('已取消删除')\r\n      }\r\n      await this.$api.updateRoleStatus(row.id, row.status)\r\n      return this.$message.success(text + \"成功\")\r\n      //await this.getRoleList()\r\n    },\r\n    // 监听添加角色对话框关闭\r\n    addRoleDialogClosed() {\r\n      this.$refs.addRoleFormRefForm.resetFields()\r\n    },\r\n    // 新增\r\n    addRole() {\r\n      this.$refs.addRoleFormRefForm.validate(async valid => {\r\n        if (!valid) return\r\n        const {data: res} = await this.$api.addRole(this.addRoleForm);\r\n        if (res.code !== 200) {\r\n          this.$message.error(res.message);\r\n        } else {\r\n          this.$message.success(\"新增角色成功\")\r\n          this.addRoleDialogVisible = false\r\n          await this.getRoleList()\r\n        }\r\n      })\r\n    },\r\n    // 监听修改角色对话框的关闭事件\r\n    editRoleDialogClosed() {\r\n      this.$refs.editRoleFormRefForm.resetFields()\r\n    },\r\n    // 展示修改对话框\r\n    async showEditRoleDialog(id) {\r\n      const {data: res} = await this.$api.roleInfo(id)\r\n      if (res.code !== 200) {\r\n        this.$message.error(res.message)\r\n      } else {\r\n        this.roleInfo = res.data\r\n        this.editRoleDialogVisible = true\r\n      }\r\n    },\r\n    // 修改角色信息并提交\r\n    editRole() {\r\n      this.$refs.editRoleFormRefForm.validate(async valid => {\r\n        if (!valid) return\r\n        const {data: res} = await this.$api.roleUpdate(this.roleInfo)\r\n        if (res.code !== 200) {\r\n          this.$message.error(res.message)\r\n        } else {\r\n          this.editRoleDialogVisible = false\r\n          await this.getRoleList()\r\n          this.$message.success(\"修改角色成功\")\r\n        }\r\n      })\r\n    },\r\n    // 删除角色\r\n    async handleRoleDelete(row) {\r\n      const confirmResult = await this.$confirm('是否确认删除角色为\"' + row.roleName + '\"的数据项？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).catch(err => err)\r\n      if (confirmResult !== 'confirm') {\r\n        return this.$message.info('已取消删除')\r\n      }\r\n      const {data: res} = await this.$api.deleteRole(row.id)\r\n      console.log(row.id)\r\n      if (res.code !== 200) {\r\n        this.$message.error(res.message)\r\n      } else {\r\n        this.$message.success('删除成功')\r\n        await this.getRoleList()\r\n      }\r\n    },\r\n    // 展示分配菜单权限对话框\r\n    showSetMenuDialog(role) {\r\n      this.id = role.id\r\n      this.$api.querySysMenuVoList().then(\r\n          res => {\r\n            this.menuList = this.$handleTree.toTreeList(res.data.data)\r\n          }\r\n      )\r\n      this.$api.QueryRoleMenuIdList(role.id).then(\r\n          res => {\r\n            this.defKeys = res.data.data\r\n          }\r\n      )\r\n      console.log(this.data)\r\n      this.setMenuDialogVisible = true\r\n    },\r\n    // 监听对话框关闭事件\r\n    setRightDialogClosed() {\r\n      this.defKeys = []\r\n    },\r\n    // 分配菜单权限\r\n    async allotMenus() {\r\n      const keys = [\r\n        ...this.$refs.treeRef.getCheckedKeys(),\r\n        ...this.$refs.treeRef.getHalfCheckedKeys()\r\n      ]\r\n      const {data: res} = await this.$api.AssignPermissions(this.id, keys)\r\n      if (res.code !== 200) {\r\n        this.$message.error(res.message)\r\n      } else {\r\n        this.$message.success('分配权限成功')\r\n        await this.getRoleList()\r\n        this.setMenuDialogVisible = false\r\n      }\r\n    },\r\n\r\n  },\r\n  created() {\r\n    this.getRoleList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/*::v-deep .el-dialog{\r\n  height: 200px;\r\n}*/\r\n\r\n.Permission-Assignment {\r\n  width: auto;\r\n  height: 50vh;\r\n  display: block;\r\n  overflow-y: scroll;\r\n\r\n.Permission-Assignment-tree {\r\n  background-color: #F5F5F5;\r\n  padding-top: 20px;\r\n  padding-bottom: 20px;\r\n}\r\n\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}